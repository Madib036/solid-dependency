{
  "currentUserLogin": "Madib036",
  "threadUrl": "https://github.com/copilot/c/f6af22ef-6e00-4329-aa9f-96dd03831b89",
  "threadName": "Open a pull request with improvements",
  "messages": [
    {
      "id": "root",
      "role": "user",
      "createdAt": "",
      "threadID": "",
      "references": null
    },
    {
      "id": "cb84937a-5be4-4eb8-8b05-be19ad90498c",
      "parentMessageID": "root",
      "intent": "conversation",
      "role": "user",
      "content": "Yes",
      "createdAt": "2025-12-20T09:29:48.158016278Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "11379059-1d86-4208-a557-ad56b4a0aa2f",
      "parentMessageID": "cb84937a-5be4-4eb8-8b05-be19ad90498c",
      "intent": "conversation",
      "role": "assistant",
      "content": "Got it — can you clarify what you mean by “Yes”? What would you like me to do next? For example:\n\n- Create or update a GitHub issue\n- Draft a pull request or review an existing one\n- Search code in a repository or explain a file\n- Run a web search for up-to-date info\n- Write or modify a file (show me the repo/owner and branch)\n- Answer a question or provide instructions\n\nTell me which of these (or something else) and any details (repo name, issue text, query, etc.).",
      "createdAt": "2025-12-20T09:29:48.158042227Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "00daf09c-bdf6-4ff4-9911-7bd37ea0e839",
      "parentMessageID": "37083e13-6490-42b0-9353-6fc7a8283de5",
      "intent": "conversation",
      "role": "user",
      "content": "Open a PR with this change.\nMake additional improvements (e.g., validate cfg contents after load, handle empty confPath)",
      "createdAt": "2025-12-20T09:30:04.663543623Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "82fcf46f-ea5b-428e-86b6-61d8ae116fca",
      "parentMessageID": "00daf09c-bdf6-4ff4-9911-7bd37ea0e839",
      "intent": "conversation",
      "role": "assistant",
      "content": "I can make those changes and open a PR, but I need a few details before I can push anything.\n\nWhat I need from you\n- Repository (owner/name), e.g. \"acme/my-repo\" — I cannot proceed without the owner/repo.\n- Path(s) of the file(s) to change (or confirm I should search the repo for the config loader).\n- Preferred base branch (e.g. main) and preferred feature branch name (I can pick one like fix/config-validate if you want).\n- PR title and short description (or I can draft them: e.g. \"Validate config after load; handle empty confPath\" with a summary of changes).\n- Any language / project constraints I should know about (Go, Python, Node, etc.), or tests/style guidelines.\n\nPlanned changes (what I'll implement)\n- If confPath is empty:\n  - either treat as \"use built-in default\" (if repo expects that) or return a clear error — confirm which behavior you want.\n- After loading config file:\n  - validate required fields are present and types/values are sensible (e.g., non-empty strings, positive ints, valid host/port, etc.).\n  - surface validation errors with actionable messages.\n- Add unit tests for:\n  - empty confPath behavior\n  - invalid/missing required fields\n  - valid config passes\n- Add/update small integration or README note if needed.\n- Add or update error-wrapping/log lines for easier debugging.\n\nNext step\n- Provide the repo owner/name and the other details above and I will:\n  1) create a branch,\n  2) implement the changes,\n  3) run tests (if available in CI or locally where possible),\n  4) open a PR and paste the PR link here.\n\nIf you want, I can also draft the exact code changes here for review before pushing — tell me the language and the config-loading file path and I’ll produce a patch. Which repository should I use?",
      "createdAt": "2025-12-20T09:30:04.663567129Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "9d37b99c-f64a-4d74-bd77-bbce1f28d0fc",
      "parentMessageID": "82fcf46f-ea5b-428e-86b6-61d8ae116fca",
      "intent": "conversation",
      "role": "user",
      "content": "internal/config/config.go\n",
      "createdAt": "2025-12-20T09:31:24.158392812Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "c535da2c-aefe-419b-97f5-4aa9588b256a",
      "parentMessageID": "9d37b99c-f64a-4d74-bd77-bbce1f28d0fc",
      "intent": "conversation",
      "role": "assistant",
      "content": "",
      "createdAt": "2025-12-20T09:31:24.158409752Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "93f6ff85-1c2f-4d96-83bc-e8be2dc4cb3a",
      "parentMessageID": "c535da2c-aefe-419b-97f5-4aa9588b256a",
      "intent": "conversation",
      "role": "user",
      "content": "package config\n\nimport (\n\t\"path/filepath\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// SetConfig reads a config file and returs an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tconfPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\tviper.Load(confPath, &Default)\n\n\treturn nil\n}",
      "createdAt": "2025-12-20T09:31:50.989885493Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "121724a5-8e16-478d-9575-5ffbc20e1c18",
      "parentMessageID": "93f6ff85-1c2f-4d96-83bc-e8be2dc4cb3a",
      "intent": "conversation",
      "role": "assistant",
      "content": "",
      "createdAt": "2025-12-20T09:31:50.98991744Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "b8f51f05-e9ec-40a7-9d5f-3325325234c0",
      "parentMessageID": "root",
      "role": "user",
      "content": "package config\n\nimport (\n\t\"path/filepath\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// SetConfig reads a config file and returs an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tconfPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\tviper.Load(confPath, &Default)\n\n\treturn nil\n}",
      "createdAt": "2025-12-20T09:32:03.428Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "a06ca56c-6187-44aa-8c5f-558c3f832519",
      "parentMessageID": "b8f51f05-e9ec-40a7-9d5f-3325325234c0",
      "intent": "conversation",
      "role": "assistant",
      "model": "",
      "content": "I noticed a few small issues and a possible improvement in your code. Main problems:\n- SetConfig ignores any error returned by viper.Load — you should capture and return that error.\n- Minor typo in the comment (\"returs\" → \"returns\").\n- Consider validating/normalizing confPath and/or returning the config instead of only mutating a global.\n\nHere's a minimal, safe fix that captures the error from viper.Load and fixes the comment. I also added a tiny guard for an empty path and a short doc comment.\n\n```go name=config.go\npackage config\n\nimport (\n\t\"errors\"\n\t\"path/filepath\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// SetConfig reads a config file and returns an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn errors.New(\"config path is empty\")\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\t// capture and return any error from viper.Load\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn err\n\t}\n\n\treturn nil\n}\n```\n\nIf you want, I can:\n- Change the API to return a *Config instead of using a global,\n- Add defaults and validation for required fields after loading,\n- Support loading from environment variables or multiple config paths.\n\nWhich (if any) of those would you like next?",
      "createdAt": "2025-12-20T09:32:19.929758928Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "8f74fb6d-d82b-47a4-9b36-896f97cbbcc7",
      "parentMessageID": "a06ca56c-6187-44aa-8c5f-558c3f832519",
      "role": "user",
      "content": "package config\n\nimport (\n\t\"errors\"\n\t\"path/filepath\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder\n",
      "createdAt": "2025-12-20T09:32:42.306Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "06667061-7155-4f01-b938-57a6b08af9eb",
      "parentMessageID": "8f74fb6d-d82b-47a4-9b36-896f97cbbcc7",
      "intent": "conversation",
      "role": "assistant",
      "model": "",
      "content": "```go name=config.go\npackage config\n\nimport (\n\t\"errors\"\n\t\"path/filepath\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// SetConfig reads a config file and returns an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn errors.New(\"config path is empty\")\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\t// capture and return any error from viper.Load\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn err\n\t}\n\n\treturn nil\n}\n```",
      "createdAt": "2025-12-20T09:33:07.134966682Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "27bb9899-391e-4079-bee8-7d37887f29a6",
      "parentMessageID": "06667061-7155-4f01-b938-57a6b08af9eb",
      "role": "user",
      "content": "package config\n\nimport (\n\t\"errors\"\n\t\"path/filepath\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// SetConfig reads a config file and returns an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn errors.New(\"config path is empty\")\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\t// capture and return any error from viper.Load\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn err\n\t}\n\n\treturn nil\n}",
      "createdAt": "2025-12-20T09:33:51.245Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "ec7fcae5-0e0d-4956-8764-2ccd666372ea",
      "parentMessageID": "27bb9899-391e-4079-bee8-7d37887f29a6",
      "intent": "conversation",
      "role": "assistant",
      "model": "",
      "content": "Nice — this is a good, small config package. I made a few practical improvements you’ll likely want:\n\n- Validate that the config file exists before calling viper.Load and return clearer wrapped errors.\n- Expand `~` in paths (common convenience when passing a home-relative path).\n- Add a lightweight `Validate()` method on Config to check required fields after loading.\n- Add a `Get()` accessor that returns a pointer to the global config (avoids copying if callers want to read it).\n- Small import cleanup and clearer error messages.\n\nIf you want, I can:\n- Make loading idempotent with sync.Once,\n- Replace the global with a return value and remove the global,\n- Add default values and environment variable overrides,\n- Add unit tests for SetConfig/Validate.\n\nHere’s an updated file with the changes applied:\n\n```go name=config.go\npackage config\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n\t\"os\"\n\t\"path/filepath\"\n\t\"strings\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// Get returns a pointer to the global configuration.\nfunc Get() *Config { return &Default }\n\n// SetConfig reads a config file and returns an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn errors.New(\"config path is empty\")\n\t}\n\n\t// expand ~/ to home directory\n\tif strings.HasPrefix(confPath, \"~\") {\n\t\thome, err := os.UserHomeDir()\n\t\tif err == nil {\n\t\t\tconfPath = filepath.Join(home, strings.TrimPrefix(confPath, \"~/\"))\n\t\t}\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to make config path absolute: %w\", err)\n\t}\n\n\t// ensure file exists (viper.Load may accept dirs depending on implementation,\n\t// but it's helpful to fail early if the user provided a bad file path)\n\tif _, err := os.Stat(absPath); err != nil {\n\t\treturn fmt.Errorf(\"config file %s: %w\", absPath, err)\n\t}\n\n\t// capture and return any error from viper.Load\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn fmt.Errorf(\"failed to load config from %s: %w\", absPath, err)\n\t}\n\n\t// validate required fields after loading\n\tif err := Default.Validate(); err != nil {\n\t\treturn fmt.Errorf(\"invalid configuration: %w\", err)\n\t}\n\n\treturn nil\n}\n\n// Validate performs basic checks for required configuration fields.\n// Extend this with more complete validation as needed.\nfunc (c *Config) Validate() error {\n\tvar missing []string\n\n\tif c.App.LogLevel == \"\" {\n\t\tmissing = append(missing, \"app.log_level\")\n\t}\n\n\t// check a subset of fields that are likely required — extend as needed\n\tif c.ValidatorsSettings.RootFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.root_folder.path\")\n\t}\n\tif c.ValidatorsSettings.ChainFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.chain_folder.path\")\n\t}\n\tif c.ValidatorsSettings.AssetFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.asset_folder.path\")\n\t}\n\n\tif len(missing) > 0 {\n\t\treturn fmt.Errorf(\"missing required config keys: %v\", missing)\n\t}\n\treturn nil\n}\n```\n\nWould you like me to:\n- convert this package to return a non-global config (preferred for testability),\n- or add sync.Once so SetConfig is safe to call multiple times?",
      "createdAt": "2025-12-20T09:34:14.021780772Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "a66fde8a-9093-4798-ab3d-b0ee65fdcb9d",
      "parentMessageID": "ec7fcae5-0e0d-4956-8764-2ccd666372ea",
      "role": "user",
      "content": "add sync.Once so SetConfig is safe to call multiple times",
      "createdAt": "2025-12-20T09:34:39.036Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "0a7240df-3fb8-426a-8d37-5923b3ba80c5",
      "parentMessageID": "a66fde8a-9093-4798-ab3d-b0ee65fdcb9d",
      "intent": "conversation",
      "role": "assistant",
      "model": "",
      "content": "I added sync.Once to make SetConfig safe to call multiple times. The first call performs the load/validation; subsequent calls are no-ops and return the same error (if any) from the initial load. I kept the existing Validate() logic and Get() accessor so callers can read the global config.\n\nChanges:\n- added package-level sync.Once and loadErr\n- wrapped actual loading logic in a helper used by once.Do\n- documented that subsequent calls are ignored (path param is only used on the first call)\n\n```go name=config.go\npackage config\n\nimport (\n\t\"fmt\"\n\t\"os\"\n\t\"path/filepath\"\n\t\"strings\"\n\t\"sync\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// once ensures SetConfig only performs loading once.\nvar once sync.Once\n\n// loadErr stores the result of the initial SetConfig call (nil on success).\nvar loadErr error\n\n// Get returns a pointer to the global configuration.\nfunc Get() *Config { return &Default }\n\n// SetConfig reads a config file and initializes the global config.\n// This function is safe to call multiple times — the first caller\n// performs the load and validation; subsequent calls are no-ops and\n// return the same error (if any). The confPath parameter is only used\n// by the first caller.\nfunc SetConfig(confPath string) error {\n\tonce.Do(func() {\n\t\tloadErr = setConfigOnce(confPath)\n\t})\n\treturn loadErr\n}\n\nfunc setConfigOnce(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn fmt.Errorf(\"config path is empty\")\n\t}\n\n\t// expand ~/ to home directory\n\tif strings.HasPrefix(confPath, \"~\") {\n\t\tif home, err := os.UserHomeDir(); err == nil {\n\t\t\tconfPath = filepath.Join(home, strings.TrimPrefix(confPath, \"~/\"))\n\t\t}\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to make config path absolute: %w\", err)\n\t}\n\n\t// ensure file exists\n\tif _, err := os.Stat(absPath); err != nil {\n\t\treturn fmt.Errorf(\"config file %s: %w\", absPath, err)\n\t}\n\n\t// load into global Default\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn fmt.Errorf(\"failed to load config from %s: %w\", absPath, err)\n\t}\n\n\t// validate loaded configuration\n\tif err := Default.Validate(); err != nil {\n\t\treturn fmt.Errorf(\"invalid configuration: %w\", err)\n\t}\n\n\treturn nil\n}\n\n// Validate performs basic checks for required configuration fields.\n// Extend this with more complete validation as needed.\nfunc (c *Config) Validate() error {\n\tvar missing []string\n\n\tif c.App.LogLevel == \"\" {\n\t\tmissing = append(missing, \"app.log_level\")\n\t}\n\n\tif c.ValidatorsSettings.RootFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.root_folder.path\")\n\t}\n\tif c.ValidatorsSettings.ChainFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.chain_folder.path\")\n\t}\n\tif c.ValidatorsSettings.AssetFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.asset_folder.path\")\n\t}\n\n\tif len(missing) > 0 {\n\t\treturn fmt.Errorf(\"missing required config keys: %v\", missing)\n\t}\n\treturn nil\n}\n```\n\nIf you want a test-friendly API, I can add a ResetForTests() function to clear the once state and Default, so tests can call SetConfig multiple times with different files. Would you like that?",
      "createdAt": "2025-12-20T09:35:05.095725266Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "4978cc63-418a-494d-bd6a-3160f9157703",
      "parentMessageID": "0a7240df-3fb8-426a-8d37-5923b3ba80c5",
      "role": "user",
      "content": "Yes",
      "createdAt": "2025-12-20T09:35:17.341Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    },
    {
      "id": "033fd51d-ee91-4705-905a-6c78ad37d951",
      "parentMessageID": "4978cc63-418a-494d-bd6a-3160f9157703",
      "intent": "conversation",
      "role": "assistant",
      "model": "",
      "content": "```go name=config.go\npackage config\n\nimport (\n\t\"fmt\"\n\t\"os\"\n\t\"path/filepath\"\n\t\"strings\"\n\t\"sync\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// once ensures SetConfig only performs loading once.\nvar once sync.Once\n\n// loadErr stores the result of the initial SetConfig call (nil on success).\nvar loadErr error\n\n// Get returns a pointer to the global configuration.\nfunc Get() *Config { return &Default }\n\n// SetConfig reads a config file and initializes the global config.\n// This function is safe to call multiple times — the first caller\n// performs the load and validation; subsequent calls are no-ops and\n// return the same error (if any). The confPath parameter is only used\n// by the first caller.\nfunc SetConfig(confPath string) error {\n\tonce.Do(func() {\n\t\tloadErr = setConfigOnce(confPath)\n\t})\n\treturn loadErr\n}\n\nfunc setConfigOnce(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn fmt.Errorf(\"config path is empty\")\n\t}\n\n\t// expand ~/ to home directory\n\tif strings.HasPrefix(confPath, \"~\") {\n\t\tif home, err := os.UserHomeDir(); err == nil {\n\t\t\tconfPath = filepath.Join(home, strings.TrimPrefix(confPath, \"~/\"))\n\t\t}\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to make config path absolute: %w\", err)\n\t}\n\n\t// ensure file exists\n\tif _, err := os.Stat(absPath); err != nil {\n\t\treturn fmt.Errorf(\"config file %s: %w\", absPath, err)\n\t}\n\n\t// load into global Default\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn fmt.Errorf(\"failed to load config from %s: %w\", absPath, err)\n\t}\n\n\t// validate loaded configuration\n\tif err := Default.Validate(); err != nil {\n\t\treturn fmt.Errorf(\"invalid configuration: %w\", err)\n\t}\n\n\treturn nil\n}\n\n// Validate performs basic checks for required configuration fields.\n// Extend this with more complete validation as needed.\nfunc (c *Config) Validate() error {\n\tvar missing []string\n\n\tif c.App.LogLevel == \"\" {\n\t\tmissing = append(missing, \"app.log_level\")\n\t}\n\n\tif c.ValidatorsSettings.RootFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.root_folder.path\")\n\t}\n\tif c.ValidatorsSettings.ChainFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.chain_folder.path\")\n\t}\n\tif c.ValidatorsSettings.AssetFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.asset_folder.path\")\n\t}\n\n\tif len(missing) > 0 {\n\t\treturn fmt.Errorf(\"missing required config keys: %v\", missing)\n\t}\n\treturn nil\n}\n\n// ResetForTests resets package-level state so tests can call SetConfig\n// multiple times with different files.\n//\n// WARNING: This function is intended for use in tests only. It is NOT\n// safe to call concurrently with other package functions outside of a\n// test harness. It resets the global config, the once guard, and the\n// stored load error.\nfunc ResetForTests() {\n\tonce = sync.Once{}\n\tDefault = Config{}\n\tloadErr = nil\n}\n```",
      "createdAt": "2025-12-20T09:35:39.880165348Z",
      "threadID": "f6af22ef-6e00-4329-aa9f-96dd03831b89",
      "references": [],
      "skillExecutions": []
    }
  ],
  "files": {
    "config.go": [
      {
        "version": 1,
        "messageId": "a06ca56c-6187-44aa-8c5f-558c3f832519",
        "id": "file:config.go#10.8",
        "language": "go",
        "name": "config.go",
        "value": "package config\n\nimport (\n\t\"errors\"\n\t\"path/filepath\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// SetConfig reads a config file and returns an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn errors.New(\"config path is empty\")\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\t// capture and return any error from viper.Load\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn err\n\t}\n\n\treturn nil\n}",
        "type": "file",
        "timestamp": "2025-12-20T09:32:19.929Z",
        "isStreaming": false,
        "isUserEdited": false
      },
      {
        "version": 2,
        "messageId": "06667061-7155-4f01-b938-57a6b08af9eb",
        "id": "file:config.go#12.1",
        "language": "go",
        "name": "config.go",
        "value": "package config\n\nimport (\n\t\"errors\"\n\t\"path/filepath\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// SetConfig reads a config file and returns an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn errors.New(\"config path is empty\")\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\t// capture and return any error from viper.Load\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn err\n\t}\n\n\treturn nil\n}",
        "type": "file",
        "timestamp": "2025-12-20T09:33:07.134Z",
        "isStreaming": false,
        "isUserEdited": false
      },
      {
        "version": 3,
        "messageId": "ec7fcae5-0e0d-4956-8764-2ccd666372ea",
        "id": "file:config.go#14.17",
        "language": "go",
        "name": "config.go",
        "value": "package config\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n\t\"os\"\n\t\"path/filepath\"\n\t\"strings\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// Get returns a pointer to the global configuration.\nfunc Get() *Config { return &Default }\n\n// SetConfig reads a config file and returns an initialized config instance.\nfunc SetConfig(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn errors.New(\"config path is empty\")\n\t}\n\n\t// expand ~/ to home directory\n\tif strings.HasPrefix(confPath, \"~\") {\n\t\thome, err := os.UserHomeDir()\n\t\tif err == nil {\n\t\t\tconfPath = filepath.Join(home, strings.TrimPrefix(confPath, \"~/\"))\n\t\t}\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to make config path absolute: %w\", err)\n\t}\n\n\t// ensure file exists (viper.Load may accept dirs depending on implementation,\n\t// but it's helpful to fail early if the user provided a bad file path)\n\tif _, err := os.Stat(absPath); err != nil {\n\t\treturn fmt.Errorf(\"config file %s: %w\", absPath, err)\n\t}\n\n\t// capture and return any error from viper.Load\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn fmt.Errorf(\"failed to load config from %s: %w\", absPath, err)\n\t}\n\n\t// validate required fields after loading\n\tif err := Default.Validate(); err != nil {\n\t\treturn fmt.Errorf(\"invalid configuration: %w\", err)\n\t}\n\n\treturn nil\n}\n\n// Validate performs basic checks for required configuration fields.\n// Extend this with more complete validation as needed.\nfunc (c *Config) Validate() error {\n\tvar missing []string\n\n\tif c.App.LogLevel == \"\" {\n\t\tmissing = append(missing, \"app.log_level\")\n\t}\n\n\t// check a subset of fields that are likely required — extend as needed\n\tif c.ValidatorsSettings.RootFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.root_folder.path\")\n\t}\n\tif c.ValidatorsSettings.ChainFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.chain_folder.path\")\n\t}\n\tif c.ValidatorsSettings.AssetFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.asset_folder.path\")\n\t}\n\n\tif len(missing) > 0 {\n\t\treturn fmt.Errorf(\"missing required config keys: %v\", missing)\n\t}\n\treturn nil\n}",
        "type": "file",
        "timestamp": "2025-12-20T09:34:14.021Z",
        "isStreaming": false,
        "isUserEdited": false
      },
      {
        "version": 4,
        "messageId": "0a7240df-3fb8-426a-8d37-5923b3ba80c5",
        "id": "file:config.go#16.8",
        "language": "go",
        "name": "config.go",
        "value": "package config\n\nimport (\n\t\"fmt\"\n\t\"os\"\n\t\"path/filepath\"\n\t\"strings\"\n\t\"sync\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// once ensures SetConfig only performs loading once.\nvar once sync.Once\n\n// loadErr stores the result of the initial SetConfig call (nil on success).\nvar loadErr error\n\n// Get returns a pointer to the global configuration.\nfunc Get() *Config { return &Default }\n\n// SetConfig reads a config file and initializes the global config.\n// This function is safe to call multiple times — the first caller\n// performs the load and validation; subsequent calls are no-ops and\n// return the same error (if any). The confPath parameter is only used\n// by the first caller.\nfunc SetConfig(confPath string) error {\n\tonce.Do(func() {\n\t\tloadErr = setConfigOnce(confPath)\n\t})\n\treturn loadErr\n}\n\nfunc setConfigOnce(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn fmt.Errorf(\"config path is empty\")\n\t}\n\n\t// expand ~/ to home directory\n\tif strings.HasPrefix(confPath, \"~\") {\n\t\tif home, err := os.UserHomeDir(); err == nil {\n\t\t\tconfPath = filepath.Join(home, strings.TrimPrefix(confPath, \"~/\"))\n\t\t}\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to make config path absolute: %w\", err)\n\t}\n\n\t// ensure file exists\n\tif _, err := os.Stat(absPath); err != nil {\n\t\treturn fmt.Errorf(\"config file %s: %w\", absPath, err)\n\t}\n\n\t// load into global Default\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn fmt.Errorf(\"failed to load config from %s: %w\", absPath, err)\n\t}\n\n\t// validate loaded configuration\n\tif err := Default.Validate(); err != nil {\n\t\treturn fmt.Errorf(\"invalid configuration: %w\", err)\n\t}\n\n\treturn nil\n}\n\n// Validate performs basic checks for required configuration fields.\n// Extend this with more complete validation as needed.\nfunc (c *Config) Validate() error {\n\tvar missing []string\n\n\tif c.App.LogLevel == \"\" {\n\t\tmissing = append(missing, \"app.log_level\")\n\t}\n\n\tif c.ValidatorsSettings.RootFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.root_folder.path\")\n\t}\n\tif c.ValidatorsSettings.ChainFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.chain_folder.path\")\n\t}\n\tif c.ValidatorsSettings.AssetFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.asset_folder.path\")\n\t}\n\n\tif len(missing) > 0 {\n\t\treturn fmt.Errorf(\"missing required config keys: %v\", missing)\n\t}\n\treturn nil\n}",
        "type": "file",
        "timestamp": "2025-12-20T09:35:05.095Z",
        "isStreaming": false,
        "isUserEdited": false
      },
      {
        "version": 5,
        "messageId": "033fd51d-ee91-4705-905a-6c78ad37d951",
        "id": "file:config.go#18.1",
        "language": "go",
        "name": "config.go",
        "value": "package config\n\nimport (\n\t\"fmt\"\n\t\"os\"\n\t\"path/filepath\"\n\t\"strings\"\n\t\"sync\"\n\n\t\"github.com/trustwallet/go-libs/config/viper\"\n)\n\ntype (\n\tConfig struct {\n\t\tApp                App                `mapstructure:\"app\"`\n\t\tClientURLs         ClientURLs         `mapstructure:\"client_urls\"`\n\t\tURLs               URLs               `mapstructure:\"urls\"`\n\t\tTimeFormat         string             `mapstructure:\"time_format\"`\n\t\tValidatorsSettings ValidatorsSettings `mapstructure:\"validators_settings\"`\n\t}\n\n\tApp struct {\n\t\tLogLevel string `mapstructure:\"log_level\"`\n\t}\n\n\tClientURLs struct {\n\t\tBinance struct {\n\t\t\tDex      string `mapstructure:\"dex\"`\n\t\t\tExplorer string `mapstructure:\"explorer\"`\n\t\t} `mapstructure:\"binance\"`\n\t\tAssetsManagerAPI string `mapstructure:\"assets_manager_api\"`\n\t}\n\n\tURLs struct {\n\t\tAssetsApp string `mapstructure:\"assets_app\"`\n\t\tLogo      string `mapstructure:\"logo\"`\n\t}\n\n\tValidatorsSettings struct {\n\t\tRootFolder                 RootFolder                 `mapstructure:\"root_folder\"`\n\t\tChainFolder                ChainFolder                `mapstructure:\"chain_folder\"`\n\t\tAssetFolder                AssetFolder                `mapstructure:\"asset_folder\"`\n\t\tChainInfoFolder            ChainInfoFolder            `mapstructure:\"chain_info_folder\"`\n\t\tChainValidatorsAssetFolder ChainValidatorsAssetFolder `mapstructure:\"chain_validators_asset_folder\"`\n\t\tDappsFolder                DappsFolder                `mapstructure:\"dapps_folder\"`\n\t}\n\n\t// Folder types hold path configuration for various validators' assets.\n\t// Keep these simple so mapstructure can populate them from config files.\n\tRootFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainInfoFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tChainValidatorsAssetFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n\n\tDappsFolder struct {\n\t\tPath string `mapstructure:\"path\"`\n\t}\n)\n\n// Default is a configuration instance.\nvar Default = Config{} //nolint:gochecknoglobals // config must be global\n\n// once ensures SetConfig only performs loading once.\nvar once sync.Once\n\n// loadErr stores the result of the initial SetConfig call (nil on success).\nvar loadErr error\n\n// Get returns a pointer to the global configuration.\nfunc Get() *Config { return &Default }\n\n// SetConfig reads a config file and initializes the global config.\n// This function is safe to call multiple times — the first caller\n// performs the load and validation; subsequent calls are no-ops and\n// return the same error (if any). The confPath parameter is only used\n// by the first caller.\nfunc SetConfig(confPath string) error {\n\tonce.Do(func() {\n\t\tloadErr = setConfigOnce(confPath)\n\t})\n\treturn loadErr\n}\n\nfunc setConfigOnce(confPath string) error {\n\tif confPath == \"\" {\n\t\treturn fmt.Errorf(\"config path is empty\")\n\t}\n\n\t// expand ~/ to home directory\n\tif strings.HasPrefix(confPath, \"~\") {\n\t\tif home, err := os.UserHomeDir(); err == nil {\n\t\t\tconfPath = filepath.Join(home, strings.TrimPrefix(confPath, \"~/\"))\n\t\t}\n\t}\n\n\tabsPath, err := filepath.Abs(confPath)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to make config path absolute: %w\", err)\n\t}\n\n\t// ensure file exists\n\tif _, err := os.Stat(absPath); err != nil {\n\t\treturn fmt.Errorf(\"config file %s: %w\", absPath, err)\n\t}\n\n\t// load into global Default\n\tif err := viper.Load(absPath, &Default); err != nil {\n\t\treturn fmt.Errorf(\"failed to load config from %s: %w\", absPath, err)\n\t}\n\n\t// validate loaded configuration\n\tif err := Default.Validate(); err != nil {\n\t\treturn fmt.Errorf(\"invalid configuration: %w\", err)\n\t}\n\n\treturn nil\n}\n\n// Validate performs basic checks for required configuration fields.\n// Extend this with more complete validation as needed.\nfunc (c *Config) Validate() error {\n\tvar missing []string\n\n\tif c.App.LogLevel == \"\" {\n\t\tmissing = append(missing, \"app.log_level\")\n\t}\n\n\tif c.ValidatorsSettings.RootFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.root_folder.path\")\n\t}\n\tif c.ValidatorsSettings.ChainFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.chain_folder.path\")\n\t}\n\tif c.ValidatorsSettings.AssetFolder.Path == \"\" {\n\t\tmissing = append(missing, \"validators_settings.asset_folder.path\")\n\t}\n\n\tif len(missing) > 0 {\n\t\treturn fmt.Errorf(\"missing required config keys: %v\", missing)\n\t}\n\treturn nil\n}\n\n// ResetForTests resets package-level state so tests can call SetConfig\n// multiple times with different files.\n//\n// WARNING: This function is intended for use in tests only. It is NOT\n// safe to call concurrently with other package functions outside of a\n// test harness. It resets the global config, the once guard, and the\n// stored load error.\nfunc ResetForTests() {\n\tonce = sync.Once{}\n\tDefault = Config{}\n\tloadErr = nil\n}",
        "type": "file",
        "timestamp": "2025-12-20T09:35:39.880Z",
        "isStreaming": false,
        "isUserEdited": false
      }
    ]
  }
}